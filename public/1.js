webpackJsonp([1],{201:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(0),r=s.n(n),i=s(76),a=s(13),o=function(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),e=t.innerHTML,t=void 0,e},l={linkLine:{regex:/(?:\#\!)\s*(.*?)\s*#*\s*(?:\!\#)/m,handle:function(e){for(var t=void 0;null!==(t=this.regex.exec(e));)e=e.replace(t[0],'<a class="yuan-send-select-message" style="display: inline-block;color: #3184ff;padding-top: 5px;" >'+o(t[1].trim())+"</a>").trim();return e}},addAttribute:{regex:/(!\[(.*?)\:(.*?)\])\((.*?)\)/m,handle:function(e){for(var t=void 0;null!==(t=this.regex.exec(e));)e=e.replace(t[0],"<span "+t[2]+'="'+t[3]+'" >'+o(t[4].trim())+"</span>").trim();return e}},breakWord:{regex:/\r\n?|\n/g,handle:function(e){return e.replace(this.regex,"<br />")}}},c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e};function u(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,s){return function n(r,i){try{var a=t[r](i),o=a.value}catch(e){return void s(e)}if(!a.done)return Promise.resolve(o).then(function(e){n("next",e)},function(e){n("throw",e)});e(o)}("next")})}}var m={value:"",type:"left",duration:0},d={keyword:"",weight:0,message:[Object(a.a)(m)]};t.default={props:{},data:function(){return{loading:!1,query:"",placeholder:"关键字",inputHover:!1,dialogVisible:!1,form:Object(a.a)(d),submitting:!1}},mounted:function(){var e=u(r.a.mark(function e(){var t,s,n,i,a,o,l;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.$notify,s=this.$route,n=this.gSettingCurrent,i=this.settingShow,a=this.messageCurrent,o=s.params.id,l=n(o),this.loading=!0,l){e.next=9;break}return e.next=7,i(o);case 7:200!==e.sent.status&&(o=null);case 9:if(null===o){e.next=16;break}return e.next=12,a(o);case 12:e.sent,t({message:"加载完成.",title:"提示",type:"success"}),e.next=18;break;case 16:throw t.error({message:"发生错误",title:"警告"}),new Error("Error . id error");case 18:this.loading=!1;case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:c({},Object(i.b)({aCreate:"message/store",aUpdate:"message/update",aDelete:"message/destroy",messageCurrent:"message/current",settingShow:"setting/settingShow",settingDefault:"setting/setDefault"}),{handleCreate:function(){this.form=Object(a.a)(d),this.dialogVisible=!0},clearQuery:function(){"circle-close"===this.inputIcon&&(this.query="")},addMessageTo:function(e,t){console.log("index :",t>=this.form.message.length),t>=this.form.message.length?this.addMessageItem():this.form.message.splice(t,0,Object(a.a)(m))},addMessageItem:function(){var e=this;this.form.message.push(Object(a.a)(m)),this.$nextTick(function(){e.containScrollBottom("contain")})},removeMessageItem:function(e){this.form.message.splice(e,1)},containScrollBottom:function(e){var t=this.$refs[e];t.scrollTop=t.scrollHeight},handleUpdate:function(e){this.form=this.checkUpdateMessage(Object(a.a)(e)),this.dialogVisible=!0},checkUpdateMessage:function(e){var t=e.message||[];return t=t.map(function(e){if(e.value&&!e.type){var t=Object(a.a)(m);t.value=e.value,e=t}return e}),e.message=t,e},validatorKeyword:function(e,t,s){""===t?s(new Error("输入内容!")):this.gNameExists(t,this.form.id)?s(new Error("关键字已存在")):s()},handleSubmit:function(e){var t,s=this,n=this.$refs,i=this.$notify,a=this.form,o=this.aCreate,l=this.aUpdate,c=this.closeDialog;n[e].validate((t=u(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=16;break}if(s.submitting=!0,!a.id){e.next=8;break}return e.next=5,l(a);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,o(a);case 10:e.t0=e.sent;case 11:200===e.t0.status&&i({title:"恭喜",message:"操作成功.",type:"success"}),c(),e.next=17;break;case 16:i.error({message:"不行哦，Message is Empty.",title:"提示"});case 17:case"end":return e.stop()}},e,s)})),function(e){return t.apply(this,arguments)}))},handleDelete:function(){var e=u(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.deleting=!0,e.next=3,this.aDelete(t.id);case 3:204===e.sent.status?this.$notify({title:"恭喜",message:"你杀死了"+t.keyword,type:"success"}):this.$notify.error({title:"错误",message:"发生意外"});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),handleSetDefault:function(){var e=u(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.settingDefault(t);case 2:200===e.sent.status&&this.$notify({title:"Congratulations",message:"He became king.",type:"success"});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),closeDialog:function(){this.form=Object(a.a)(d),this.submitting=!1,this.dialogVisible=!1},closedDialog:function(){this.$refs.form.resetFields()},closeDialogBefore:function(e){this.form&&this.form.id&&(this.form=Object(a.a)(d)),this.submitting||e()},strParse:function(e){return function(e){for(var t in l)e=l[t].handle(e);return e}(e)}}),computed:c({},Object(i.c)({gCurrent:"message/current",gSettingCurrent:"setting/current",gList:"message/message",gNameExists:"message/nameExists"}),{isCurrent:function(){return this.gCurrent(this.$route.params.id)},loaded:function(){return!(this.loading||!this.currentMessage)},settingCurrent:function(){return this.gSettingCurrent(this.$route.params.id)},currentMessage:function(){return this.isCurrent&&this.gList},inputIcon:function(){return this.query.length>0&&this.inputHover?"circle-close":"search"},filterable:function(){var e=this.currentMessage,t=this.query;return!!e&&(""===t?e:e.filter(function(e){return e.keyword.toLowerCase().indexOf(t.toLowerCase())>-1}))},currentDefault:function(){return this.settingCurrent.default_message}})}},202:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:!e.loaded,expression:"!loaded",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"message-list_container"},[e.loaded?s("div",[s("div",{staticClass:" admin-component-header message-header"},[s("div",{staticClass:"admin-header_filter"},[s("el-input",{attrs:{size:"small",placeholder:e.placeholder},nativeOn:{mouseenter:function(t){e.inputHover=!0},mouseleave:function(t){e.inputHover=!1}},model:{value:e.query,callback:function(t){e.query=t},expression:"query"}},[s("i",{class:["el-input__icon","el-icon-"+e.inputIcon],attrs:{slot:"prefix"},on:{click:e.clearQuery},slot:"prefix"})])],1),e._v(" "),s("div",{staticClass:"admin-header_controller"},[s("el-button",{attrs:{type:"primary"},on:{click:e.handleCreate}},[e._v("\n                    新建\n                ")])],1)]),e._v(" "),e.currentMessage?0===e.currentMessage.length?s("div",[e._v("\n            一条都没有\n            "),s("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加一条吧")])],1):s("el-row",{attrs:{gutter:30}},e._l(e.filterable,function(t){return s("el-col",{key:t.id,staticStyle:{"margin-bottom":"15px"},attrs:{span:8}},[s("el-card",{staticClass:"message-card mac-card"},[s("div",{staticClass:"message-card_content"},[s("div",{staticClass:"message-card_url-bar card-url-bar"},[e._v("\n                            "+e._s(t.keyword)+"\n                        ")]),e._v(" "),e._l(t.message,function(t,n){return s("div",{key:n,class:"message-pop_wrap message-pop_"+t.type},["custom"===t.type?s("div",{domProps:{innerHTML:e._s(t.value)}}):s("div",{staticClass:"message-pop"},[s("p",{staticClass:"message-pop_text",domProps:{innerHTML:e._s(e.strParse(t.value))}})])])}),e._v(" "),s("div",{staticClass:"message-card-footer mac-card-footer"},[s("el-button",{staticClass:"setting-card-btn",attrs:{disabled:e.currentDefault===t.id,type:"text"},on:{click:function(s){e.handleSetDefault(t.id)}}},[e._v("\n                                设定默认\n                            ")]),e._v(" "),s("el-button",{staticClass:"setting-card-btn",attrs:{type:"text"},on:{click:function(s){e.handleUpdate(t)}}},[e._v("\n                                变更\n                            ")]),e._v(" "),s("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.modelShow,callback:function(s){e.$set(t,"modelShow",s)},expression:"item.modelShow"}},[s("p",[e._v("这是一段内容这是一段内容确定删除吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.modelShow=!1}}},[e._v("取消\n                                    ")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini",loading:t.deleting},on:{click:function(s){e.handleDelete(t)}}},[e._v("确定\n                                    ")])],1),e._v(" "),s("el-button",{staticClass:"setting-card-btn",attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("\n                                    削除\n                                ")])],1)],1)],2)])],1)})):s("div",[e._v("\n            数据出错.\n        ")]),e._v(" "),s("el-dialog",{ref:"dialog",attrs:{title:"提示",visible:e.dialogVisible,width:"700px"},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.closedDialog,"before-close":e.closeDialogBefore}},[s("el-form",{ref:"form",attrs:{model:e.form,"label-position":"top","label-width":"120px"}},[s("el-form-item",{attrs:{label:"关键词",prop:"keyword",rules:[{validator:e.validatorKeyword,trigger:["blur","change"]}]}},[s("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.keyword,callback:function(t){e.$set(e.form,"keyword",t)},expression:"form.keyword"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"权重",prop:"weight"}},[s("el-input-number",{attrs:{"controls-position":"right",min:0,max:1e3},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}})],1),e._v(" "),s("h1",[e._v("\n                    回复短句\n                    "),s("el-button",{attrs:{icon:"el-icon-circle-plus",type:"text"},on:{click:e.addMessageItem}},[e._v("\n                        加增\n                    ")])],1),e._v(" "),s("div",{ref:"contain",staticClass:"message-value-container"},e._l(e.form.message,function(t,n){return s("div",{key:n,staticClass:"message-list-item"},[s("el-form-item",{staticClass:"message-value-form-item",attrs:{rules:{required:!0,message:"不行哦",trigger:"blur"},prop:"message."+n+".value"}},[s("el-input",{attrs:{placeholder:"输入内容..",type:"textarea",autosize:{minRows:2,maxRows:4},resize:"none"},model:{value:t.value,callback:function(s){e.$set(t,"value",s)},expression:"item.value"}})],1),e._v(" "),s("div",{staticClass:"message-value-attribute"},[s("el-form-item",{staticClass:"message-item-attribute-inline"},[s("el-select",{attrs:{size:"mini",placeholder:"信息位置"},model:{value:t.type,callback:function(s){e.$set(t,"type",s)},expression:"item.type"}},e._l([{value:"left",label:"左侧"},{value:"right",label:"右侧"},{value:"center",label:"中间"},{value:"custom",label:"自定义内容"}],function(e){return s("el-option",{key:e.value,attrs:{"controls-position":"right",label:e.label,value:e.value}})}))],1),e._v(" "),s("el-form-item",{staticClass:"message-item-attribute-inline"},[s("el-input-number",{attrs:{size:"mini",min:0,max:3e3,label:"延迟"},model:{value:t.duration,callback:function(s){e.$set(t,"duration",s)},expression:"item.duration"}})],1),e._v(" "),s("el-button",{attrs:{icon:"el-icon-caret-top",type:"text"},on:{click:function(t){e.addMessageTo("before",n)}}},[e._v("\n                                在上方插入一行\n                            ")]),e._v(" "),s("el-button",{attrs:{icon:"el-icon-caret-bottom",type:"text"},on:{click:function(t){e.addMessageTo("after",n+1)}}},[e._v("\n                                在下方插入一行\n                            ")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.form.message&&e.form.message.length>1,expression:"form.message && form.message.length > 1"}],attrs:{icon:"el-icon-circle-close",type:"text"},on:{click:function(t){e.removeMessageItem(n)}}},[e._v("\n                                削除\n                            ")])],1)],1)}))],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("\n                    取 消\n                ")]),e._v(" "),s("el-button",{attrs:{loading:e.submitting,type:"primary"},on:{click:function(t){e.handleSubmit("form")}}},[e._v("\n                    确 定\n                ")])],1)],1)],1):e._e()])},staticRenderFns:[]}},217:function(e,t,s){var n=s(75)(s(201),s(202),!1,null,null,null);e.exports=n.exports}});