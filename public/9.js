webpackJsonp([9],{207:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(0),a=n.n(i),o=n(76),s={setting_id:null,open:!1,domain:"",description:"",tags:[],tagText:"",showTagInput:!1},r=n(13),l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};function c(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){return function i(a,o){try{var s=e[a](o),r=s.value}catch(t){return void n(t)}if(!s.done)return Promise.resolve(r).then(function(t){i("next",t)},function(t){i("throw",t)});t(r)}("next")})}}e.default={data:function(){return{query:"",inputHover:!1,dialogVisible:!1,submitting:!1,placeholder:"请",form:Object(r.a)(s),loading:!1}},mounted:function(){console.log(312),this.gDomains||this.getDomains()},methods:l({},Object(o.b)({aDomains:"domain/index",aUpdate:"domain/update",aDestroy:"domain/destroy",aCreate:"domain/create"}),{getDomains:function(){var t=c(a.a.mark(function t(){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.aDomains();case 2:t.sent;case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),handleOpen:function(){var t=c(a.a.mark(function t(e){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.opening=!0,t.next=3,this.aUpdate({id:e.id,open:e.open});case 3:200===t.sent.status?this.$notify({title:"成功",message:"你"+(e.open?"打开":"封印")+"了他.",type:"success"}):(e.open=!e.open,this.$notify({title:"警告",message:"发送了非常轻微的错误.",type:"warning"})),e.opening=!1;case 6:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleDelete:function(){var t=c(a.a.mark(function t(e){return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:204===this.aDestroy(e.id).status?this.$notify({message:"删除了",type:"success",title:"恭喜"}):this.$notify.error({message:"出错了",title:"警告"});case 2:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),handleUpdateBtn:function(t){this.form=Object(r.a)(t),this.dialogVisible=!0},handleSubmit:function(t){var e,n=this,i=this.$refs,o=this.$message,s=this.form,r=this.$notify,l=this.aCreate,u=this.aUpdate,d=this.closeDialog;i[t].validate((e=c(a.a.mark(function t(e){var i;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=4;break}o({type:"warning",message:"看仔细一点."}),t.next=18;break;case 4:if(n.submitting=!0,s.id){t.next=11;break}return t.next=8,l(s);case 8:t.t0=t.sent,t.next=14;break;case 11:return t.next=13,u(s);case 13:t.t0=t.sent;case 14:i=t.t0,console.log(i),i&&200===i.status?r({message:"操作成功",title:"恭喜",type:"success"}):r({message:"发生了一点小意外",title:"提示",type:"warning"}),d();case 18:case"end":return t.stop()}},t,n)})),function(t){return e.apply(this,arguments)}))},clearQuery:function(){"circle-close"===this.inputIcon&&(this.query="")},closeDialog:function(){this.form=Object(r.a)(s),this.submitting=!1,this.dialogVisible=!1},closedDialog:function(){this.$refs.form.resetFields()},closeDialogBefore:function(t){this.form&&this.form.id&&(this.form=Object(r.a)(s)),this.submitting||t()},validatorDomain:function(t,e,n){var i=this.form,a=this.gDomains;""===e?n(new Error("输入内容!")):-1!==a.findIndex(function(t){return i.id!==t.id&&t.domain.toLowerCase()===e.toLowerCase()})?n(new Error("域名已存在")):n()},handleAddTag:function(t){if(""!==t){var e=this.form.tags;-1===e.findIndex(function(e){return e===t})&&e.push(t)}this.form.showTagInput=!1,this.form.tagText=""},handleCloseTag:function(t){t>=0&&this.form.tags.splice(t,1)},showInput:function(){var t=this;this.form.showTagInput=!0,this.$nextTick(function(){t.$refs.saveTagInput.$refs.input.focus()})}}),computed:l({},Object(o.c)({gDomains:"domain/domains",settingOf:"setting/idOf",gSettings:"setting/list"}),{filterable:function(){var t=this.gDomains,e=this.query;return!!t&&(""===e?t:t.filter(function(t){return t.domain.toLowerCase().indexOf(e.toLowerCase())>-1}))},inputIcon:function(){return this.query.length>0&&this.inputHover?"circle-close":"search"},loaded:function(){return!(this.loading||!this.gSettings||!this.gDomains)}})}},208:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loaded?n("div",[n("div",{staticClass:"admin-component-header"},[n("div",{staticClass:"admin-header_filter message-header_filter"},[n("el-input",{attrs:{size:"small",placeholder:t.placeholder},nativeOn:{mouseenter:function(e){t.inputHover=!0},mouseleave:function(e){t.inputHover=!1}},model:{value:t.query,callback:function(e){t.query=e},expression:"query"}},[n("i",{class:["el-input__icon","el-icon-"+t.inputIcon],attrs:{slot:"prefix"},on:{click:t.clearQuery},slot:"prefix"})])],1),t._v(" "),n("div",{staticClass:"admin-header_controller"},[n("el-button",{attrs:{disabled:0===t.gSettings.length,type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("\n                新建\n            ")])],1)]),t._v(" "),t.filterable?0===t.gSettings.length?n("h1",[t._v("\n        缺少配置.不能添加域名\n        "),n("el-button",{attrs:{type:"text"}},[n("router-link",{attrs:{to:"/admin/setting"}},[t._v("去添加.")])],1)],1):0===t.filterable.length?n("h1",[t._v("\n        Not Found Data.\n        "),n("el-button",{attrs:{type:"text"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("Add Domain.")])],1):n("el-row",{attrs:{gutter:20}},t._l(t.filterable,function(e){return n("el-col",{key:e.id,staticStyle:{"margin-bottom":"20px"},attrs:{span:8}},[n("el-card",{staticClass:"domain-card mac-card"},[n("div",{staticClass:"domain-card_content"},[n("div",{staticClass:"domain-card_url-bar card-url-bar"},[t._v("\n                        "+t._s(e.domain)+"\n                    ")]),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.opening,expression:"item.opening"}],staticClass:"domain-card_open-wrap"},[n("div",{staticClass:"open-label"},[t._v("\n                            开关\n                        ")]),t._v(" "),n("el-switch",{on:{change:function(n){t.handleOpen(e)}},model:{value:e.open,callback:function(n){t.$set(e,"open",n)},expression:"item.open"}}),t._v(" "),n("span",{staticClass:"domain-card_setting-name"},[t._v(t._s(t.settingOf(e.setting_id).name))])],1),t._v(" "),n("div",{staticClass:"domain-card_tags"},[n("h1",[t._v("\n                            标签:\n                        ")]),t._v(" "),0===e.tags.length?n("div",[t._v("\n                            没有标签.\n                        ")]):t._l(e.tags,function(e,i){return n("el-tag",{key:i},[t._v(t._s(e))])})],2),t._v(" "),n("div",{staticClass:"domain-card-footer mac-card-footer",staticStyle:{"text-align":"right"}},[n("el-button",{staticClass:"setting-card-btn",attrs:{type:"text"},on:{click:function(n){t.handleUpdateBtn(e)}}},[t._v("\n                            变更\n                        ")]),t._v(" "),n("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.modelShow,callback:function(n){t.$set(e,"modelShow",n)},expression:"item.modelShow"}},[n("p",[t._v("这是一段内容这是一段内容确定删除吗？")]),t._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"0"}},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.modelShow=!1}}},[t._v("取消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini",loading:e.deleting},on:{click:function(n){t.handleDelete(e)}}},[t._v("确定\n                                ")])],1),t._v(" "),n("el-button",{staticClass:"setting-card-btn",attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("\n                                削除\n                            ")])],1)],1)])])],1)})):n("h1",[t._v("\n        乍回事啊,叫人\n    ")]),t._v(" "),n("el-dialog",{ref:"dialog",staticClass:"domain-dialog-container",attrs:{title:"提示",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.closedDialog,"before-close":t.closeDialogBefore}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-position":"top","label-width":"120px"}},[n("el-form-item",{attrs:{label:"域名",prop:"domain",rules:[{validator:t.validatorDomain,trigger:["blur","change"]}]}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:t.form.domain,callback:function(e){t.$set(t.form,"domain",e)},expression:"form.domain"}},[n("template",{slot:"prepend"},[t._v("Http://")])],2)],1),t._v(" "),n("el-form-item",{attrs:{label:"开关",prop:"open"}},[n("el-switch",{model:{value:t.form.open,callback:function(e){t.$set(t.form,"open",e)},expression:"form.open"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"备注",prop:"description",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[n("el-input",{model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),n("el-form-item",{staticClass:"domain-dialog-tag-wrap",attrs:{label:"标签"}},[t._l(t.form.tags,function(e,i){return n("el-tag",{key:i,attrs:{closable:"","disable-transitions":!1},on:{close:function(e){t.handleCloseTag(i)}}},[t._v("\n                    "+t._s(e)+"\n                ")])}),t._v(" "),t.form.showTagInput?n("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(e){t.handleAddTag(t.form.tagText)}},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.handleAddTag(t.form.tagText)}},model:{value:t.form.tagText,callback:function(e){t.$set(t.form,"tagText",e)},expression:"form.tagText"}}):n("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")])],2),t._v(" "),n("el-form-item",{attrs:{label:"所属",prop:"setting_id",rules:{required:!0,message:"不能为空",trigger:"blur"}}},[n("el-select",{attrs:{placeholder:"请"},model:{value:t.form.setting_id,callback:function(e){t.$set(t.form,"setting_id",e)},expression:"form.setting_id"}},t._l(t.gSettings,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("\n                取 消\n            ")]),t._v(" "),n("el-button",{attrs:{loading:t.submitting,type:"primary"},on:{click:function(e){t.handleSubmit("form")}}},[t._v("\n                确 定\n            ")])],1)],1)],1):t._e()},staticRenderFns:[]}},219:function(t,e,n){var i=n(75)(n(207),n(208),!1,null,null,null);t.exports=i.exports}});